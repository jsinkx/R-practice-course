---
title: '–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –≥–∏–ø–æ—Ç–µ–∑ –ø–æ –¥–∞—Ç–∞—Å–µ—Ç—É Boston'
author: 'Artemiy Voronin SHAD-312 (not sku-f, just BRUN-man ü¶∏Ô∏è)'
output: html_document
---

```{r}
library(MASS)
library(ggplot2)
library(dplyr)
library(corrplot)
library(tidyr)

options(warn = -1)

data("Boston")
data_houses <- Boston

head(data_houses)

dim(data_houses)

str(data_houses)

summary(data_houses)

# crime   - —É—Ä–æ–≤–µ–Ω—å –ø—Ä–µ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –Ω–∞ —á–µ–ª–æ–≤–µ–∫–∞ –Ω–∞—Å–µ–ª–µ–Ω–∏—è –≤ —Ä–∞–∑–±–∏–≤–∫–µ –ø–æ –≥–æ—Ä–æ–¥–∞–º
# zn      - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–µ–º–µ–ª—å –ø–æ–¥ –∂–∏–ª—É—é –∑–∞—Å—Ç—Ä–æ–π–∫—É, —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã—Ö –Ω–∞ —É—á–∞—Å—Ç–∫–∏ –ø–ª–æ—â–∞–¥—å—é –±–æ–ª–µ–µ 25 000 –∫–≤.—Ñ—É—Ç–æ–≤
# indus   - –¥–æ–ª—è –∞–∫—Ä–æ–≤ (0.4 –≥–µ–∫—Ç–∞—Ä), –Ω–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å —Ä–æ–∑–Ω–∏—á–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–µ–π, –≤ —Ä–∞—Å—á–µ—Ç–µ –Ω–∞ –æ–¥–∏–Ω –≥–æ—Ä–æ–¥
# chas    - –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è Charles River (= 1, –µ—Å–ª–∏ —É—á–∞—Å—Ç–æ–∫ –≥—Ä–∞–Ω–∏—á–∏—Ç —Å —Ä–µ–∫–æ–π; 0 –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ)
# nox     - –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –æ–∫—Å–∏–¥–æ–≤ –∞–∑–æ—Ç–∞ (—á–∞—Å—Ç–µ–π –Ω–∞ 10 –º–∏–ª–ª–∏–æ–Ω–æ–≤)
# rm      - —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–Ω–∞—Ç –≤ –¥–æ–º–µ
# age     - –¥–æ–ª—è –∂–∏–ª—ã—Ö –ø–æ–º–µ—â–µ–Ω–∏–π, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –≤–ª–∞–¥–µ–ª—å—Ü–∞–º–∏ –¥–æ 1940
# dis     - –≤–∑–≤–µ—à–µ–Ω–Ω—ã–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–æ –ø—è—Ç–∏ –±–æ—Å—Ç–æ–Ω—Å–∫–∏—Ö —Ü–µ–Ω—Ç—Ä–æ–≤ –∑–∞–Ω—è—Ç–æ—Å—Ç–∏
# rad     - –∏–Ω–¥–µ–∫—Å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ä–∞–¥–∏–∞–ª—å–Ω—ã—Ö –∞–≤—Ç–æ–º–∞–≥–∏—Å—Ç—Ä–∞–ª–µ–π
# tax     - —è —Å—Ç–∞–≤–∫–∞ –Ω–∞–ª–æ–≥–∞ –Ω–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å —Å –ø–æ–ª–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –Ω–∞ 10 000 –¥–æ–ª–ª–∞—Ä–æ–≤
# ptratio - —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —É—á–µ–Ω–∏–∫–æ–≤ –∏ —É—á–∏—Ç–µ–ª–µ–π –ø–æ –≥–æ—Ä–æ–¥–∞–º.
# black   - –¥–æ–ª—è —á–µ—Ä–Ω–æ–∫–æ–∂–∏—Ö –≤ —Ä–∞–∑–±–∏–≤–∫–µ –ø–æ –≥–æ—Ä–æ–¥–∞–º
# lstat   - –ø—Ä–æ—Ü–µ–Ω—Ç –Ω–∞—Å–µ–ª–µ–Ω–∏—è —Å –±–æ–ª–µ–µ –Ω–∏–∑–∫–∏–º —Å—Ç–∞—Ç—É—Å–æ–º
# medv    - —Å—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ–º–æ–≤, –∑–∞–Ω–∏–º–∞–µ–º—ã—Ö –≤–ª–∞–¥–µ–ª—å—Ü–∞–º–∏, –Ω–∞ 1000 –¥–æ–ª–ª–∞—Ä–æ–≤ –°–®–ê

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
replace_na_with_mean <- function(df) {
  df[] <- lapply(df, function(x) if (is.numeric(x)) ifelse(is.na(x), mean(x, na.rm = TRUE), x) else x)
  return(df)
}

number_of_NA <- length(which(is.na(data_houses) == TRUE))
print(paste("–ß–∏—Å–ª–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π:", number_of_NA))

data_houses <- replace_na_with_mean(data_houses)

number_of_NA <- length(which(is.na(data_houses) == TRUE))
print(paste("–ß–∏—Å–ª–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π:", number_of_NA))

data_houses$crime <- data_houses$crim

str(data_houses)

print(dim(data_houses))
print(names(data_houses))
print(head(data_houses$crime))

data_houses$crime <- as.numeric(as.character(data_houses$crime))
data_houses$medv <- as.numeric(as.character(data_houses$medv))

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏—Ç–æ–≥–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
summary(data_houses)

# --- –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏ ---
# –¶–µ–ª—å: –í—ã—è–≤–∏—Ç—å, –∫–∞–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã (–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ) –æ–∫–∞–∑—ã–≤–∞—é—Ç –≤–ª–∏—è–Ω–∏–µ –Ω–∞ —Å—Ä–µ–¥–Ω—é—é —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ–º–æ–≤ (medv).

# --- –ì–ª–æ–±–∞–ª—å–Ω–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ ---
# –°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ–º–æ–≤ (medv) –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–æ—Ü–∏–∞–ª—å–Ω–æ-—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏—Ö, —ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤.

# --- –°—É–±–≥–∏–ø–æ—Ç–µ–∑—ã ---
# 1. –£—Ä–æ–≤–µ–Ω—å –ø—Ä–µ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ (crime) –æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–ª–∏—è–Ω–∏–µ –Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∂–∏–ª—å—è.
# 2. –ë–ª–∏–∑–æ—Å—Ç—å –∫ —Ä–µ–∫–µ –ß–∞—Ä–ª—å–∑ (chas) –≤–ª–∏—è–µ—Ç –Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∂–∏–ª—å—è.
# 3. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–Ω–∞—Ç (rm) –æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∂–∏–ª—å—è.
# 4. –ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –æ–∫—Å–∏–¥–æ–≤ –∞–∑–æ—Ç–∞ (nox) –æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∂–∏–ª—å—è.
# 5. –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —É—á–µ–Ω–∏–∫–æ–≤ –∏ —É—á–∏—Ç–µ–ª–µ–π (ptratio) –≤–ª–∏—è–µ—Ç –Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∂–∏–ª—å—è.

# --- –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö ---

# –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã –¥–ª—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
quantitative_vars <- data_houses %>% select(-chas)  # chas - –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è
cor_matrix <- cor(quantitative_vars)

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã
cor_matrix <- cor(data_houses)
colors     <- colorRampPalette(c("blue", "white", "red"))(200)

corrplot(cor_matrix, col = colors, tl.col = "black", tl.srt = 45, method = "color", addCoef.col = "black", number.cex = 0.7)
# --- –ì–∏–ø–æ—Ç–µ–∑–∞ 1: –£—Ä–æ–≤–µ–Ω—å –ø—Ä–µ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ (crime) –≤–ª–∏—è–µ—Ç –Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∂–∏–ª—å—è ---
# H0: –£—Ä–æ–≤–µ–Ω—å –ø—Ä–µ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∂–∏–ª—å—è.
# H–∞: –£—Ä–æ–≤–µ–Ω—å –ø—Ä–µ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∂–∏–ª—å—è.

# –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑
cor_test_crime <- cor.test(data_houses$crime, data_houses$medv)
cor_test_crime

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
ggplot(data_houses, aes(x = crime, y = medv)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", col = "red", se = TRUE) +
  labs(title = "–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∂–∏–ª—å—è –æ—Ç —É—Ä–æ–≤–Ω—è –ø—Ä–µ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏",
       x = "–£—Ä–æ–≤–µ–Ω—å –ø—Ä–µ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ (crime)",
       y = "–°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ–º–æ–≤ (—Ç—ã—Å. $)") +
  theme_minimal()

# --- –ì–∏–ø–æ—Ç–µ–∑–∞ 2: –ë–ª–∏–∑–æ—Å—Ç—å –∫ —Ä–µ–∫–µ –ß–∞—Ä–ª—å–∑ (chas) –≤–ª–∏—è–µ—Ç –Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∂–∏–ª—å—è ---
# H0: –ë–ª–∏–∑–æ—Å—Ç—å –∫ —Ä–µ–∫–µ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∂–∏–ª—å—è.
# H–∞: –ë–ª–∏–∑–æ—Å—Ç—å –∫ —Ä–µ–∫–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∂–∏–ª—å—è.

# t-—Ç–µ—Å—Ç –¥–ª—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –≤—ã–±–æ—Ä–æ–∫
t_test_chas <- t.test(medv ~ chas, data = data_houses)
t_test_chas

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
ggplot(data_houses, aes(x = as.factor(chas), y = medv, fill = as.factor(chas))) +
  geom_boxplot(alpha = 0.7) +
  labs(title = "–°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ–º–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –±–ª–∏–∑–æ—Å—Ç–∏ –∫ —Ä–µ–∫–µ –ß–∞—Ä–ª—å–∑",
       x = "–ë–ª–∏–∑–æ—Å—Ç—å –∫ —Ä–µ–∫–µ –ß–∞—Ä–ª—å–∑ (1 - —Ä—è–¥–æ–º, 0 - –Ω–µ —Ä—è–¥–æ–º)",
       y = "–°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ–º–æ–≤ (—Ç—ã—Å. $)") +
  scale_fill_manual(values = c("skyblue", "orange")) +
  theme_minimal()

# --- –ì–∏–ø–æ—Ç–µ–∑–∞ 3: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–Ω–∞—Ç (rm) –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∂–∏–ª—å—è ---
# H0: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–Ω–∞—Ç –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∂–∏–ª—å—è.
# H–∞: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–Ω–∞—Ç –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∂–∏–ª—å—è.

# –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑
cor_test_rm <- cor.test(data_houses$rm, data_houses$medv)
cor_test_rm

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
ggplot(data_houses, aes(x = rm, y = medv)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", col = "blue", se = TRUE) +
  labs(title = "–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∂–∏–ª—å—è –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–æ–º–Ω–∞—Ç",
       x = "–°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–Ω–∞—Ç (rm)",
       y = "–°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ–º–æ–≤ (—Ç—ã—Å. $)") +
  theme_minimal()

# --- –ì–∏–ø–æ—Ç–µ–∑–∞ 4: –£—Ä–æ–≤–µ–Ω—å –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏ –æ–∫—Å–∏–¥–æ–≤ –∞–∑–æ—Ç–∞ (nox) –≤–ª–∏—è–µ—Ç –Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∂–∏–ª—å—è ---
# H0: –£—Ä–æ–≤–µ–Ω—å –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏ –æ–∫—Å–∏–¥–æ–≤ –∞–∑–æ—Ç–∞ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∂–∏–ª—å—è.
# H–∞: –£—Ä–æ–≤–µ–Ω—å –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏ –æ–∫—Å–∏–¥–æ–≤ –∞–∑–æ—Ç–∞ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∂–∏–ª—å—è.

# –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑
cor_test_nox <- cor.test(data_houses$nox, data_houses$medv)
cor_test_nox

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
ggplot(data_houses, aes(x = nox, y = medv)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", col = "green", se = TRUE) +
  labs(title = "–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∂–∏–ª—å—è –æ—Ç –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏ –æ–∫—Å–∏–¥–æ–≤ –∞–∑–æ—Ç–∞",
       x = "–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –æ–∫—Å–∏–¥–æ–≤ –∞–∑–æ—Ç–∞ (nox)",
       y = "–°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ–º–æ–≤ (—Ç—ã—Å. $)") +
  theme_minimal()

# --- –ì–∏–ø–æ—Ç–µ–∑–∞ 5: –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —É—á–µ–Ω–∏–∫–æ–≤ –∏ —É—á–∏—Ç–µ–ª–µ–π (ptratio) –≤–ª–∏—è–µ—Ç –Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∂–∏–ª—å—è ---
# H0: –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —É—á–µ–Ω–∏–∫–æ–≤ –∏ —É—á–∏—Ç–µ–ª–µ–π –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∂–∏–ª—å—è.
# H–∞: –ë–æ–ª–µ–µ –≤—ã—Å–æ–∫–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —É—á–µ–Ω–∏–∫–æ–≤ –∏ —É—á–∏—Ç–µ–ª–µ–π –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∂–∏–ª—å—è.

# –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑
cor_test_ptratio <- cor.test(data_houses$ptratio, data_houses$medv)
cor_test_ptratio

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
ggplot(data_houses, aes(x = ptratio, y = medv)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", col = "purple", se = TRUE) +
  labs(title = "–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∂–∏–ª—å—è –æ—Ç —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è —É—á–µ–Ω–∏–∫–æ–≤ –∏ —É—á–∏—Ç–µ–ª–µ–π",
       x = "–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —É—á–µ–Ω–∏–∫–æ–≤ –∏ —É—á–∏—Ç–µ–ª–µ–π (ptratio)",
       y = "–°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ–º–æ–≤ (—Ç—ã—Å. $)") +
  theme_minimal()

# --- –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏ ---
# –¶–µ–ª—å: –í—ã—è–≤–∏—Ç—å –≤–ª–∏—è–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤ –Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∂–∏–ª—å—è (`medv`).

# --- –ì–∏–ø–æ—Ç–µ–∑—ã ---
# H0: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö `medv`, `crime` –∏ –¥—Ä—É–≥–∏—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –Ω–æ—Ä–º–∞–ª—å–Ω–æ.
# H–∞: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —ç—Ç–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è –æ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ.

# --- –¢–µ—Å—Ç—ã –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å ---
# –®–∞–ø–∏—Ä–æ-–£–∏–ª–∫
shapiro_medv <- shapiro.test(data_houses$medv)
shapiro_crime <- shapiro.test(data_houses$crime)

# –ö–æ–ª–º–æ–≥–æ—Ä–æ–≤-–°–º–∏—Ä–Ω–æ–≤
ks_medv <- ks.test(data_houses$medv, "pnorm", mean(data_houses$medv), sd(data_houses$medv))
ks_crime <- ks.test(data_houses$crime, "pnorm", mean(data_houses$crime), sd(data_houses$crime))

print("–¢–µ—Å—Ç –®–∞–ø–∏—Ä–æ-–£–∏–ª–∫–∞ –¥–ª—è –º–µ–¥–≤:")
print(shapiro_medv)

print("–¢–µ—Å—Ç –ö–æ–ª–º–æ–≥–æ—Ä–æ–≤–∞-–°–º–∏—Ä–Ω–æ–≤–∞ –¥–ª—è –º–µ–¥–≤:")
print(ks_medv)

# --- –ê–Ω–∞–ª–∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö ---
# –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `chas` (–±–ª–∏–∑–æ—Å—Ç—å –∫ —Ä–µ–∫–µ –ß–∞—Ä–ª—å–∑)
# H0: –ë–ª–∏–∑–æ—Å—Ç—å –∫ —Ä–µ–∫–µ –Ω–µ —Å–≤—è–∑–∞–Ω–∞ —Å –≤—ã—Å–æ–∫–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç—å—é –∂–∏–ª—å—è (medv).
# H–∞: –ë–ª–∏–∑–æ—Å—Ç—å –∫ —Ä–µ–∫–µ —Å–≤—è–∑–∞–Ω–∞ —Å –≤—ã—Å–æ–∫–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç—å—é –∂–∏–ª—å—è.

# –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
data_houses$medv_cat <- ifelse(data_houses$medv > median(data_houses$medv), "high", "low")

# –¢–∞–±–ª–∏—Ü–∞ —Å–æ–ø—Ä—è–∂–µ–Ω–Ω–æ—Å—Ç–∏
contingency_table <- table(data_houses$chas, data_houses$medv_cat)

# –¢–µ—Å—Ç —Ö–∏-–∫–≤–∞–¥—Ä–∞—Ç
chi_test <- chisq.test(contingency_table)

# –¢–æ—á–Ω—ã–π —Ç–µ—Å—Ç –§–∏—à–µ—Ä–∞
fisher_test <- fisher.test(contingency_table)

print("–¢–µ—Å—Ç —Ö–∏-–∫–≤–∞–¥—Ä–∞—Ç:")
print(chi_test)

print("–¢–æ—á–Ω—ã–π —Ç–µ—Å—Ç –§–∏—à–µ—Ä–∞:")
print(fisher_test)

# --- –ú–æ—â–Ω–æ—Å—Ç—å –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ ---
# –£—Ä–æ–≤–µ–Ω—å –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏
alpha <- 0.05

# –®–∞–ø–∏—Ä–æ-–£–∏–ª–∫ (–¥–ª—è –º–æ—â–Ω–æ—Å—Ç–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–∏–º—É–ª—è—Ü–∏—è –∏–ª–∏ —Ä–∞—Å—á–µ—Ç)
# –û—Ü–µ–Ω–∫–∞ –º–æ—â–Ω–æ—Å—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø-–∑–Ω–∞—á–µ–Ω–∏—è
shapiro_power <- ifelse(shapiro_medv$p.value < alpha, "H0 –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞ (–º–æ—â–Ω–æ—Å—Ç—å –µ—Å—Ç—å)", "H0 –Ω–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞ (–º–æ—â–Ω–æ—Å—Ç—å –Ω–∏–∑–∫–∞—è)")

# –•–∏-–∫–≤–∞–¥—Ä–∞—Ç
chi_power <- ifelse(chi_test$p.value < alpha, "H0 –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞ (–º–æ—â–Ω–æ—Å—Ç—å –µ—Å—Ç—å)", "H0 –Ω–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞ (–º–æ—â–Ω–æ—Å—Ç—å –Ω–∏–∑–∫–∞—è)")

# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ—â–Ω–æ—Å—Ç–∏
print("–û—Ü–µ–Ω–∫–∞ –º–æ—â–Ω–æ—Å—Ç–∏ —Ç–µ—Å—Ç–æ–≤:")
print(paste("–®–∞–ø–∏—Ä–æ-–£–∏–ª–∫:", shapiro_power))
print(paste("–•–∏-–∫–≤–∞–¥—Ä–∞—Ç:", chi_power))

# --- –ì—Ä–∞—Ñ–∏–∫–∏ ---
# –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ `medv` (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏)
ggplot(data_houses, aes(x = medv)) +
  geom_histogram(bins = 30, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –¥–æ–º–æ–≤", x = "–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ–º–æ–≤ (—Ç—ã—Å. $)", y = "–ß–∞—Å—Ç–æ—Ç–∞") +
  theme_minimal()

# –ò—Ç–æ–≥–æ–≤—ã–µ –≤—ã–≤–æ–¥—ã
print("–ò—Ç–æ–≥–æ–≤—ã–µ –≤—ã–≤–æ–¥—ã:")
print("1. –¢–µ—Å—Ç—ã –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ `medv` –∏ `crime` –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º (–ø–æ –®–∞–ø–∏—Ä–æ-–£–∏–ª–∫—É).")
print("2. –•–∏-–∫–≤–∞–¥—Ä–∞—Ç –∏ —Ç–æ—á–Ω—ã–π —Ç–µ—Å—Ç –§–∏—à–µ—Ä–∞: –ï—Å—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–∞—è —Å–≤—è–∑—å –º–µ–∂–¥—É –±–ª–∏–∑–æ—Å—Ç—å—é –∫ —Ä–µ–∫–µ –∏ —Å—Ç–æ–∏–º–æ—Å—Ç—å—é –¥–æ–º–æ–≤.")
```

### –£–≤–∞–∂–∞–µ–º—ã–π, –ë–∞—Ç–∞—à–æ–≤ –†. –ê.

–í —Ä–∞–º–∫–∞—Ö –Ω–∞—à–µ–≥–æ –∫—É—Ä—Å–∞ –ø–æ R —è –Ω–∞—É—á–∏–ª—Å—è –º–Ω–æ–≥–∏–º –≤–µ—â–∞–º –∏ –≤—Å–ø–æ–º–Ω–∏–ª —Ö–æ—Ä–æ—à–æ-–∑–∞–±—ã—Ç–æ–µ —Å—Ç–∞—Ä–æ–µ: —Ä–∞–Ω–µ–µ –ø—Ä–æ–π–¥–µ–Ω–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª.

- –°–Ω–∞—á–∞–ª–∞ –Ω–∞—É—á–∏–ª—Å—è —Å–ª–µ–¥–∏—Ç—å –∑–∞ ~~–±–∞–∑–∞—Ä–æ–º~~ —è–∑—ã–∫–æ–º –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ—é —Ä–µ—á—å —Å –ø–æ–º–æ—â—å—é –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –æ–±–ª–∞–∫–∞ –∏ –¥–∏–∞–≥—Ä–∞–º–º–≤—ã —á–∞—Å—Ç–æ—Ç —Å–ª–æ–≤

- –ó–∞—Ç–µ–º –∫–∞–∫–∏–º-—Ç–æ —á—É–¥–æ–º –ø—Ä–æ–∫–∞—Ç–∏–ª—Å—è —Å –í–∞–º–∏ –Ω–∞ BMW —Ä–∞–∑–æ–±—Ä–∞–ª—Å—è –≤ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –∞–≤—Ç–æ –∏ –ø—Ä–æ–≤–µ–ª –∞–Ω–∞–ª–∏–∑ –º–∞—à–∏–Ω

<div align="center">
  <img width="420" src="./ride.jpg" alt="ride picture">
</div>

- –ù–∞—É—á–∏–ª—Å—è –∏–≥—Ä–∞—Ç—å –≤ –ø–æ–∫–µ—Ä –∏ –ø—Ä–æ–∏–≥—Ä–∞–ª –Ω–µ–º–Ω–æ–≥–æ –¥–µ–Ω–µ–≥, –∫–æ–Ω–µ—á–Ω–æ –∂–µ, –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö, –ø–æ—Ç–æ–º—É —á—Ç–æ –≥–µ–º–±–ª–∏–Ω–≥ - <b>—Ö–∞—Ä–∞–º</b>. –ù–∞–¥–µ—é—Å—å –≤ –ø–ª–µ–Ω—É —É –º–∞—Ñ–∏–æ–∑–∏ —Å–ø—Ä–∞–≤–ª—é—Å—å.

- –ü—Ä–æ–≤–µ–ª –∞–Ω–∞–ª–∏–∑ —É—á–∞—Å—Ç–∫–æ–≤ –≤ –õ–æ–Ω–¥–æ–Ω–µ –∏ –≤—ã—è—Å–Ω–∏–ª, —á—Ç–æ –∏ –∫–∞–∫ –≤–ª–∏—è–µ—Ç –Ω–∞ –∏—Ç–æ–≥–æ–≤—É—é —Å—É–º–º—É. –û–¥–Ω–∞–∫–æ –ø—Ä–∏–æ–±—Ä–µ—Ç–∞—Ç—å —É—á–∞—Å—Ç–æ–∫ –≤ –ë—Ä–∏—Ç–∞–Ω–∏–∏ –Ω–µ —Å–æ–±–∏—Ä–∞—é—Å—å.

–° —É–≤–∞–∂–µ–Ω–∏–µ–º,

–í–æ—Ä–æ–Ω–∏–Ω –ê. –ê.
